pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
--snake
--by darkbloom

-- constants

clr_bg    = 3
clr_wall  = 5
clr_snake = 12
clr_dead  = 8
clr_fruit = 9

pxlsz      = 4
grdsz      = (128/pxlsz)-1
updaterate = 3
growth     = 3

-- functions

function rndi(x, y)
	return flr(rnd(y-x+1))+x
end

function spawnfruit()
	local freecells = {}
	for y=1,grdsz-2 do
		for x=1,grdsz-2 do
			foreach(snake, function (e)
				if (x!=e[1] and y!=e[2]) add(freecells, {x, y})
			end)
		end
	end
	fruit = freecells[rndi(1,#freecells)]
end

-- callbacks

function _init()
	cntr = 0
	
	snake  = {{5,flr(grdsz/2)}}
	length = #snake
	facing = nil
	dead   = false
	
	fruit = {grdsz-5,flr(grdsz/2)}
end

function _update()
	if not dead then
		if (cntr%updaterate==0) then
			cntr = 0
			
			if     (facing==⬆️) then snake[1][2]-=1
			elseif (facing==⬇️) then snake[1][2]+=1
			elseif (facing==⬅️) then snake[1][1]-=1
			elseif (facing==➡️) then snake[1][1]+=1 end
					
			local head = snake[1]
		
			if (head[1]==fruit[1] and head[2]==fruit[2]) length+=growth spawnfruit()
			
				
			for i=2,#snake do
				dead = (dead == false) and (head[1]==snake[i][1] and head[2]==snake[i][2])
			end
		
			dead = head[1]==0 or head[1]==grdsz or head[2]==0 or head[2]==grdsz
			
			add(snake,{head[1],head[2]},2)
			if (length < #snake) deli(snake,#snake)
		end
		
		if     (btn(⬆️) and facing!=⬇️) then facing = ⬆️
		elseif (btn(⬇️) and facing!=⬆️) then facing = ⬇️
		elseif (btn(⬅️) and facing!=➡️) then facing = ⬅️
		elseif (btn(➡️) and facing!=⬅️) then facing = ➡️ end
				
		cntr+=1
	end
end

function _draw()
--	cls()
	
	for y=0,grdsz do
		for x=0,grdsz do
			local clr = clr_bg
			
			if (y==0 or y==grdsz or x==0 or x==grdsz) clr = clr_wall
			
			for i=1,#snake do
				if (x==snake[i][1] and y==snake[i][2]) clr = clr_snake
			end
			
			if (x==fruit[1] and y==fruit[2]) clr = clr_fruit
			
			if (x==snake[1][1] and y==snake[1][2] and dead) clr = clr_dead
			
			rectfill(x*pxlsz,y*pxlsz,(x+1)*pxlsz,(y+1)*pxlsz,clr)
		end
	end
	
	print("score: "..tostr(flr(length/growth)),1,1,0)
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55005500550050005000555555555000555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
50555055505050505055550555555050555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
50005055505050055005555555555050555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55503033303030303033330333333030333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
50053300300330303000333333333000333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333cccc33333333333333333333333333333333333333333333333333333333333333333333333333333333999933333333333333335555
55553333333333333333cccc33333333333333333333333333333333333333333333333333333333333333333333333333333333999933333333333333335555
55553333333333333333cccc33333333333333333333333333333333333333333333333333333333333333333333333333333333999933333333333333335555
55553333333333333333cccc33333333333333333333333333333333333333333333333333333333333333333333333333333333999933333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55553333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333335555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555

